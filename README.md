# extendible-hashing
ΑΡΧΕΙΑ ΥΛΟΠΟΙΗΣΗΣ
Η εργασία αποτελείται από τα ακόλουθα αρχεία:

makefile		(εντολές μεταγλώττισης και εκτέλεσης προγράμματος)
HP.c			(αρχείο σωρού)
HP.h			(αρχείο επικεφαλίδας αρχείου σωρού)
HT.c			(αρχείο κατακερματισμού)
HT.h			(αρχείο επικεφαλίδας κατακερματισμού)
ReadMeFile		(αρχείο επεξήγησης εργασίας)

ΑΡΧΕΙΟ ΣΩΡΟΥ (HP.c HP.h)		
Στο αρχείο HP.h υπάρχουν όλα τα πρωτότυπα των συναρτήσεων του αρχείου HP.c αλλά και  η δομή της εγγραφής (struct Record) , και η δομή-ειδική πληροφορία που περιλαμβάνει το πρώτο ‍block, το block 0 (struct Info).

Η ειδική πληροφορία περιλαμβάνει έναν ακέραιο που υποδηλώνει τον τύπο αρχείου (0 για σωρού, 1 για κατακερματισμού) και έναν ακεραιο που κρατάει τον αριθμό των συνολικών εγγραφών.

Στο αρχείο HP.c είναι υλοποιημένες όλες οι συναρτήσεις της εκφώνησης. Λίγα λόγια για την καθεμία:

int HP_CreateFile(char*)
Δημιουργεί το αρχείο σωρού, το ανοίγει, δεσμέυει χώρο για ένα μπλοκ, το μπλοκ 0, παίρνει την διεύθυνση του, αρχικοποιεί τις μεταβλητές της ειδικής πληροφορίας, τις γράφει στο μπλοκ 0, τις γράφει στον δίσκο, και στο τέλος κλείνει το αρχείο. Επιστρέφει 0 σε επιτυχία και -1 αλλιώς.

int HP_OpenFile( char *)
Ανοίγει ένα αρχείο. Διαβάζει απότ ο πρώτο μπλοκ την ειδική πληροφορία και συγκεκριμένα αν πρόκειται γι ααρχείο σωρού. Επιστρέφει το αναγνωριστικό του αρχείου σε επιτυχία, αλλιώς -1.

int HP_CloseFile( int  )
Κλείνει ένα ανοιχτό αρχείο. Επιστρέφει 0 σε επιτυχία, αλλιώς -1.

int HP_InsertEntry (int , Record  ) 

Εισάγει μια νέα εγγραφή στο τέλος του αρχείου σωρού. Η διαδικασία είναι η εξής:
Ανοίγει το πρώτο μπλοκ πληροφορίας και διαβάζει τον αριθμό των συνολικών εγγραφών. Αν δεν έχει εισαχθεί καμία εγγραφή, δεσμέυει χώρο για νέο μπλοκ (μπλοκ 1) και εισάγει εκεί την εγγραφή. Αν έχουν εισαχθεί εγγραφές, βρίσκει πόσες εγγραφές έχει το τελευταίο μπλοκ κάνοντας την κατάλληλη πράξη, και αν έχει χώρο το τελευταίο μπλοκ εισάγει εκεί την εγγραφή, αν δεν έχει δεσμεύει χώρο για νέο μπλοκ και εισάγει στο νέο μπλοκ την εγγραφή. Σε κάθε περίπτωση στο τέλος γράφονται οι αλλαγές του τελευταίου μπλοκ στον δίσκο αλλά και ενημερώνεται ο συνολικός αριθμός του πρώτου μπλοκ πληροφορίας και γράφεται επίσης στον δίσκο. Σε επιτυχία επιστρέφει 0, αλλιώς -1.
Τα μπλοκ που έχουν αποθηκευμένες εγγραφές (μπλοκ 1, μπλοκ 2, ....)  αποθηκεύουν στα πρώτα bytes έναν ακέραιο που κρατάει πόσες εγγραφές έχει το συγκεκριμένο μπλοκ. Με βάση το μέγεθος της εγγραφής Record (68 bytes) και τον μέγεθο του ακέραιου που έχουν τα μπλοκ (4 bytes) προκύπτει ότι κάθε μπλοκ χωράει 7 εγγραφές.

void HP_GetAllEntries(  int ,  char* fieldName ,  void * value)

Αναζητήται μια εγγραφή με τιμή ίση με value (τρίτη παράμετρος).Η διαδικασία είναι η εξής:
Ανοίγει το πρώτο μπλοκ πληροφορίας και διαβάζει τον συνολικό αριθμό των εγγραφών. Επίσης βρίσκει τον συνολικό αριθμό των blocks. Αν το αρχείο δεν έχει εγγραφές εμφανίζει το κατάλληλο μήνυμα. Εαν έχει εγγραφές  και η παράμετρος είναι null τότε εκτυπώνει όλες τις εγγραφές του αρχείου. Αν η παράμετρος value δεν είναι null, τότε από το μπλοκ 1 μέχρι το τελευταίο μπλοκ, ανοίγει το μπλοκ, διαβάζει τον αριθμό των εγγραφών του, και ελέγχει όλες τις εγγραφές του μπλοκ. Αν κάποια εγγραφή στο πεδίο fieldName έχει τιμή ίση με value, τότε εκτυπώνεται όλη η εγγραφή, αλλιώς εκτυπώνεται μήνυμα ότι δεν βρέθηκαν εγγραφές με αυτή την τιμή. Η αναζήτηση στο αρχείο σωρού είναι γραμμική και εμφανίζετια και ο χρόνος εκτέλεσης αναζήτησης για λόγους σύγκρισης με την αναζήτηση στο αρχείο κατακερματισμού.

ΑΡΧΕΙΟ ΚΑΤΑΚΕΡΜΑΤΙΣΜΟΥ (HT.c HT.h)

int HT_CreateIndex(char*, char, char *, int, int)
Καλείται για την δημιουργία ενός νέου αρχείου κατακερματισμού.Δεσμεύονται αρχικά δέκα μπλόκ.Το πρώτο περιέχει πληροφορίες για το αρχείο  , το δεύτερο περιέχει το ευρετήριο και τα υπόλοιπα οκτώ είναι οι αρχικοί κάδοι που αναφέρονται στην εκφώνηση.Το ευρετήριο έχει μέγεθος 2^ολικό βάθος, το οπόιο δίνεται ως παράμετρος.Σε κάθε θέση του αποθηκεύεται ένας ακέραιος που είναι ο κάδος στον οποίο οδηγεί η θέση αυτή.



HT_info*  HT_OpenIndex( char *)

Ανοίγει ένα αρχείο κατακερματισμού που περιγράφεται από την παράμετρο της συνάρτησης.

int HT_CloseIndex( HT_info* )

Κλείνει το αρχείο κατακερματισμόυ που περιγράφεται απο την παράμετρο της συνάρτησης.



int HT_InsertEntry (  HT_info* ,Record )
Εισάγει μια εγγραφή στο αρχείο Κατακερματισμού.Αρχικά φέρνει το ευρετήριο σε πίνακα για ευκολότερη χρήση του.Μετά παράγεται το κλειδί κατακερματισμού σύμφωνα με το επιλεγμένο πεδίο κατακερματισμού που δώθηκε κατά την εκτέλεση του προγράμματος.Αφού έχει βρεθεί ο
κάδος που πρέπει να μπεί η εγγραφή προσπαθεί να γράψει σε αυτόν.Σε περίπτωση που αυτό δεν είναι δυνατό ,είτε δημιουργείται καινούριος κάδος μέσω διάσπασης , είτε διπλασιάζεται ο πίνακας, είτε δημιουργείται μπλόκ υπερχέιλισης.Στις δύο πρώτες περιπτώσεις οι εγγραφές που βρίσκονταν στον αρχικό κάδο επανακατακερματίζονται στους δύο κάδους.






oid HT_GetAllEntries( HT_info* ,  void *)

Εκτυπώνει τις εγγραφές που βρίσκονται στο αρχείο κατακερματισμού που δίνεται ως παράμετρος , οι οποίες έχουν πεδίο κλειδί ίσο με την τιμή που δίνεται επίσης ως παράμετρος.
Αν δεν δίνεται τιμή παραμέτρου (NULL) , τότε εκτυπώνονται όλες οι εγγραφές που υπάρχουν στο αρχείο κατακερματισμού με την σειρά ( μπλόκ προς μπλόκ).Στην περίπτωση που δίνεται τιμή σύγκρισης για το πεδίο κλειδί ,τότε κατακερματίζεται η τιμή αυτή και οδηγεί στον  κάδο που βρίσκονται οι ανάλογες εγγραφές, αν υπάρχουν.Μετά γίνεται αναζήτηση στον κάδο αυτόν και τις πιθανές περιοχές υπερχείλισης του και εκτύπωνονται τα αποτελέσματα αν υπάρχουν.
Τέλος εκτυπώνεται ο χρόνος εκτέλεσης αναζήτησης για λόγους σύγκρισης με την αναζήτηση στο αρχείο σωρού.



int hash_keyInt(int ,int) 

Συνάρτηση κατακερματισμού από τον σύνδεσμο  
http://www.cs.hmc.edu/~geoff/classes/hmc.cs070.200101/homework10/hashfuncs.html 

int hash_keyChar(char * , int ) 

Συνάρτηση κατακερματισμού από τον σύνδεσμο 
 http://stackoverflow.com/questions/7666509/hash-function-for-string 

int hashing(HT_info * , Record , int)

Παράγει μια τιμή από μηδέν έως μέγεθος ευρετηρίου.Η τιμή αυτή χρησμοποιείται για να μπεί η εγγραφή στον κατάλληλο κάδο.
 
int write_in_overflow(int  , int  , Record  )

Παίρνει ως παράμετρο έναν κάδο , την εγγραφή και τον περιγραφέα του αρχείου κατακερματισμού και προσπαθεί να εισάγει την εγγραφή αυτή στον κάδο αυτόν ή σε κάποια περιοχή υπερχείλισης του.Η συνάρτηση δεν δεσμεύει καινούρια περιοχή υπερχείλισης και στην περίπτωση πολλών περιοχών υπερχείλισης  γράφει στην πρώτη που δεν είναι γεμάτη. Σε περίπτωση επιτυχίας επιστρέφετε μηδέν , αλλιώς επιστρέφεται ένα.


void total_records( int , int  , Record * , int * )

Επιστρέφει τον αριθμό των εγγραφών που έχει ο κάδος που παίρνει σαν παράμετρο.Συμπεριλαμβάνονται και όλες οι πιθανές εγγραφές σε περιοχές υπερχέιλισης.



void fill_array( int , int  , Record * , int * )

Παίρνει σαν παράμετρο έναν δείκτή σε έναν πίνακα εγγραφών και τον γεμίζει με τις εγγραφές του κάδου που παίρνει επίσης σαν παράμετρο.Συμπεριλαμβάνονται και όλες οι πιθανές εγγραφές σε περιοχές υπερχέιλισης.

void empty_bucket(int , int  )

Αδειάζει τον κάδο που δίνεται ως παράμετρος..Συμπεριλαμβάνονται και όλες οι πιθανές εγγραφές σε περιοχές υπερχέιλισης. Η συνάρτηση αυτή γενικά καλείται όταν πρέπει να επανακατακερματιστούν οι εγγραφές λόγω αύξησης των κάδων.



void create_and_write_to_overflow(int , int  ,Record )

Φτίαχνεται μια περιοχή υπερχείλισης για τον κάδο που δίνεται ως παράμετρος και γράφεται η εγγραφή σε αυτόν.Στην περίπτωση που ο κάδος έχει ήδη μια ή περισσότερες περιοχές υπερχείλισης , η νέα θα μπεί στο τέλος αυτών.




 ΕΝΤΟΛΕΣ ΜΕΤΑΓΛΩΤΤΙΣΗΣ

1)make -f Makefile.HT
2)make -f Makefile.HP
3)make -f Makefile.total

ΕΝΤΟΛΕΣ ΕΚΤΕΛΕΣΗΣ

1)./mainHT < records2
2)./mainHP <records2
3)./main <records2
